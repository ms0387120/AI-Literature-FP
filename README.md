# AI-Literature - Final Project
###### tags: `Course` `AI文學`


## 使用工具
### Python
* 為這次作業實施中最主要的程式語言，做劇本生成的工作。
### 繁體中文結巴套件
* 進行句子的有效斷詞
* 採用和原始結巴相同的演算法
* 替換其詞庫及HMM機率表製做出針對台灣繁體的結巴斷詞器
### Stanford NLP
* 是一個自然語言處理套件，可支援多國語言
* 裡面有許多繁體中文的模型，不過裡面的模型本身是由Java寫成，雖然Stanford 也有在Python提供一些套件，但都不怎麼精準
* 因此，我們這組額外去建立環境：將 Java 模型運行至Python上
* 主要使用 **POS Tagger**、**Dependency Parser**
* 前者協助查找文章中的所有字詞詞性，以建立「人物」跟「地點」列表。後者則是處理「對話」相關內容
### CNA 資料集
* 是一個中文 word embedding 的資料集
* 主要是做相似詞獲取，以得到詞與詞之間的 cos similarity，協助我們抓取地點、人物可以更精準。


---
## 元素提取
### Character & Location
* 先對文本行行做預處理：結巴、POS，根據一些規則來收集候選名詞，之後透過我們訓練的模型檢測，來確定「人物列表」、「地點列表」

![](https://i.imgur.com/Xx4N80j.png)

### Dialogue
* 針對有對話的句子做處理，先 Dependency Parser查找句子中主詞跟受詞人物，然後進行說話人識別，就可以得出 (說話人,對話內容)、人物動作補充等訊息。

![](https://i.imgur.com/x6A1J3G.png)

   
---
## 劇本場景設定
### 場景判斷
* **依照「時」、「空」分景**

    - 時間分為 清晨、白天、黃昏、晚上
    - 空間就是依照地點列表
* 在讀取文本時，每行文字都會紀錄其時空
* **只要跟前期狀態不同，尤其是對於地點特別敏感，立即切換場景**
* **地點在文本中所屬位置會影響分景正確度**

### 空間判斷
* 主要是「**偵測對話框內的地點**」或「**偵測對話框外的地點**」
* 設計 ==**對話地點判斷器**==
* 以三隻小豬為例，以對話內的地點為偵測目標

    - 因為在故事裡，三隻小豬蓋的建築物大多以在對話內出現次數最多(明顯多於對話框外)，因此以對話內容當作依據來切換場景，會比較準確
* 以小紅帽為例，以對話外的地點為偵測目標

    - 因為故事發生地點多在對話外就會顯示，不會在對話內容說明。就算有，也擔心會有偏誤。比方說：小紅帽在森林(對話外)時，一直說要去奶奶家(對話內)

* **但根據我們的實驗，多數故事都以「對話外」當作空間判斷的依據**


---
## Entity Expansion
* 相較於之前的sub-project，這次的程式要處理之前沒有處理過的故事
* 為了能更精準的判別「人物」跟「地點」，我們用 CNA word embedding 來擴張「人物」跟「地點」資料集
* 呼叫cosine similarity來找到跟資料集中詞彙最接近的十個單字加入資料集
* 最後再用人工確認新的「人物」跟「地點」資料集是正確的
* 我們也寫出了一個logistic regression分類器來判定不確定的單詞是否屬於「人物」跟「地點」


---
## 案例結果
| 故事 | 小紅帽 | 三隻小豬 |
| :--------: | :--------: | :--------: |
| 人物     | [‘奶奶’, ‘媽媽’, ‘小紅帽’, ‘狼’, ‘獵人’]     | [‘媽媽’, ‘大哥’, ‘二哥’, ‘小弟’, ‘野狼’]     |
| 地點     | [‘奶奶家’, ‘家’, ‘森林’]     | [‘稻草屋’, ‘家’, ‘木屋子’, ‘磚屋’]     |
| 幕數     | 3     | 5     |
| 切景方式     | 對話外     | 對話內     |
| 劇本正確度     | 97 %     | 97 %     |

### 小紅帽 - 分析
* 角色、地點都有標出
* 只有一句小紅帽的對白被標成媽媽的

### 三隻小豬 - 分析
* 人物、地點大都標對了
* 沒有識別「三隻小豬」是人物，造成對白錯誤


---
## 比賽結果
| 故事 | 白雪公主 | 補鞋匠的奇特經歷 |
| :--------: | :--------: | :--------: |
| 人物     | ['國王', '王后', '白雪公主', '魔鏡', '僕人', '老婆婆', '農婦', '王子']     | ['法官', '法蒂瑪', '馬魯夫']     |
| 地點     | ['森林', '王宮', '家', '山頂']     | ['家', '清真寺', '補鞋攤']     |
| 幕數     | 6     | 4     |
| 切景方式     | 對話外     | 對話外     |
| 劇本正確度     | 94 %     | 63 %     |

### 白雪公主 - 分析
* 出場的角色都成功辨別為「人物」，但無法了解「老婆婆」跟 「農婦」都是皇后
* 有幾句對白標給了錯誤的人物
* 地點辨別的還可以，但斷幕可能因為原本故事沒有一直提及地點的變更，以致效果略差
* 總體而言，劇本蠻忠於原作的

### 補鞋匠的奇特經歷 - 分析
* 人物方面沒有抓到「鄰居」、「差役」、「店老闆」，這應該是因為我們訓練時都用類似格林童話那樣的故事大量使用擬人角色的故事
* 文本中代名詞的大量應用讓角色對白效果不彰
* 地點基本上只有「法院」沒有辨別出。故事中有大量的劇情是在「街道」上發生，但沒有明確的用「街道」這個詞彙，造成場景的不準確
* 總體來說，因為文本跟訓練資料差太多造成我們的結果不好


---
## Conclusion
* Stanford NLP 有助於元素抽取
* Entity Expansion 提高「人物」、「地點」判斷的精準度
* 場景切割對地點特別敏感，時間其次，因為在故事中時間可能不像地點特別說明出來
* 生成忠於原作的劇本


---

